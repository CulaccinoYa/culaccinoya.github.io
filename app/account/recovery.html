<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=0">
		<link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/5.2.2/css/bootstrap.min.css"/>
		<link href="https://cdn.bootcdn.net/ajax/libs/jquery-confirm/3.3.4/jquery-confirm.min.css" rel="stylesheet">
		<style>input::-webkit-outer-spin-button,input::-webkit-inner-spin-button{-webkit-appearance:none}*:focus{outline: 0;}</style>
		<title>自助解限</title>
	</head>
	<body>
		<div id="preloader" style="position:fixed;width:100%;height:100vh;background-color:#fbfbfb;z-index:99999;">
			<div style="display:block;text-align:center;margin-top:40vh;">
				<div class="spinner-border ml-auto" aria-hidden="true"></div>
			</div>
			<div style="font-size:.8rem;margin-top:40vh;text-align:center">
				<p class="text-secondary">&copy;Copyright SF工具箱 All.right.<br>长时间无反应?返回后再试试</p>
			</div>
		</div>
		<div class="p-4" id='index'>
		    <h3 class="mt-4"><b>账户受限</b></h3>
		    <p style="font-size: .8rem;">您的账号暂时无法登录，详情如下</p>
		    <div class="card border border-0 border-top border-5 border-danger shadow rounded">
		        <div class="card-body">
		            <h5><svg width="24" height="24" viewBox="0 0 48 48"><path d="M24 44C29.5228 44 34.5228 41.7614 38.1421 38.1421C41.7614 34.5228 44 29.5228 44 24C44 18.4772 41.7614 13.4772 38.1421 9.85786C34.5228 6.23858 29.5228 4 24 4C18.4772 4 13.4772 6.23858 9.85786 9.85786C6.23858 13.4772 4 18.4772 4 24C4 29.5228 6.23858 34.5228 9.85786 38.1421C13.4772 41.7614 18.4772 44 24 44Z" fill="none" stroke="#333" stroke-width="4" stroke-linejoin="round"/><path fill-rule="evenodd" clip-rule="evenodd" d="M24 37C25.3807 37 26.5 35.8807 26.5 34.5C26.5 33.1193 25.3807 32 24 32C22.6193 32 21.5 33.1193 21.5 34.5C21.5 35.8807 22.6193 37 24 37Z" fill="#333"/><path d="M24 12V28" stroke="#333" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/></svg>&nbsp;温馨提示</h5>
		            <p>您的账户已被<span class="text-danger" id="type"></span>，原因为：</p>
		            <p class="text-danger text-center" style="font-weight:bold;" id="reason"></p>
		            <p id="times">当前账户将在<span class="text-primary">2023年1月1日 00:00</span>后自动恢复正常，在此之前，无论是自助解限还是人工客服都无法解除您的账户状态</p>
		            <p id="time">您可以通过下方的<span class="text-primary">解除限制</span>按钮解除账户限制，解除限制后，下一次违反可能会加强惩罚，在你未进行此操作前，系统不会恢复你的账户</p>
		            <p>若您对本次结果产生疑问，可<a href="//sf.suxber.live/app/system/group.html">联系人工客服</a></p>
				</div>
		    </div>
			<button class="mt-4 col-12 btn btn-primary rounded-pill">解除限制</button>
		</div>
		
		<div class="p-4" id="finish" style="display: none;">
		    <div class="text-center" style="margin-top:20vh">
		        <h2><b>解限成功</b></h2>
		        <p class="text-secondary">请您退出本页面，并继续完成登录</p>
		    </div>
		</div>

        <script type="text/javascript" src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/jquery/3.6.0/jquery.min.js"></script>
        <script src="https://cdn.bootcdn.net/ajax/libs/jquery-confirm/3.3.4/jquery-confirm.min.js"></script>
        <script>
			document.onreadystatechange = function(){
				if(document.readyState == 'complete'){
					document.getElementById("preloader").style.display="none";
				}
			}
            $(function(){
				$('#times').hide();
				$('#reason').text(decodeURIComponent(getvalue('reason')));
				if(getvalue('type')=='1'){
					$('#type').text('限制登录');
				}else if(getvalue('type')=='2'){
					$('#type').text('限制登录');
					$('button').hide();
					$('#times').show();
					$('#time').hide();
					$('#times span').text(timetostring(getvalue('times')));
				}else if(getvalue('type')=='3'){
					$('#type').text('冻结');
				}else if(getvalue('type')=='4'){
					$('#type').text('冻结');
					$('#time').text('您只能通过人工客服的方式恢复您的账户');
					$('button').hide();
				}else{
					$('#type').text('永久封禁');
					$('#time').hide();
					$('button').hide();
				}
            })
			$('button').click(function(){
				let user=getvalue('user');
				let code=getvalue('code');
                let loading=$.alert({title:'',content:'<div class="p-2 d-flex align-items-center justify-content-between"> <strong>操作正在处理</strong> <div class="spinner-border ml-auto" role="status" aria-hidden="true"></div></div>',buttons:[],closeIcon:false});
                $.ajax({
                	type:"POST",
                	timeout:10000,
                	url:"https://sf-api.suxber.live/Account/Recovery",
                	data:JSON.stringify({"data":{},"account":{"user":user,"code":code}}),
                	contentType:"application/json;charset=UTF-8",
                	success:function (data) {
                		loading.close();
                	    if(data.code==200){
                			$('#index').hide();
                            $('#finish').show();
                		}else if(data.code==300){
                			window.location.href=data.data;
                		}else{
                			$.alert({title:'错误',type:'red',content:data.msg}); 
                		}
                	},
                	error:function (msg) {
                	    loading.close();
                		$.alert({title:'错误',type:'red',content:'网络异常，请稍后再试'}); 
                	}
                });
            });
            function getvalue(variable) {
				var query = window.location.search.substring(1);
				var vars = query.split("&");
			    for (var i = 0; i < vars.length; i++) {
			        var pair = vars[i].split("=");
			        if (pair[0] == variable) {
			            return pair[1]
			        }
			    }
			    return null;
			}
			function timetostring(times) {
				var time = new Date(parseInt(times));
				var y = time.getFullYear();
				var m = time.getMonth() + 1;
				var d = time.getDate();
				var h = time.getHours();
				if (h < 10) {
					h = '0' + h;
				}
				var mm = time.getMinutes();
				if (mm < 10) {
					mm = '0' + mm;
				}
				var s = time.getSeconds();
				if (s < 10) {
					s = '0' + s;
				}
				return y + '年' + m + '月' + d + '日' + ' ' + h + ":" + mm + ":" + s;

			}
        </script>
	</body>
</html>
